<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Seller Upload</title>
<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
</head>

<body>
<div class="container">
	<div class="row">
    	<div class="col-lg-12">
            <div class="col-lg-4">
            	<label>Category</label>
                <select name="" id="cat">
                	<option value="">Select a Category</option>
                	<option value="Men">Men</option>
                    <option value="Women">Women</option>
                    <option value="Kids">Kids</option>
                    <option value="Beauty">Beauty</option>
                </select>
            </div>
            <div class="col-lg-4">
            	<label>Subcategory</label>
                <select name="" id="subcat" disabled="true">
                <option value="">Select a Subcategory</option>
                </select>
            </div>
            <div class="col-lg-4">
            	<label>Product Type</label>
                <select name="" id="producttype" disabled="true">
                <option value="">Select a Subcategory</option>
                </select>
            </div>
        </div>
        
        
        
        <div class="col-lg-12" id="uploadForm" style="display:none">
        <hr />	
		<form method="POST" enctype="multipart/form-data" action="http://10.11.19.19:9191/erp/upload">
		File to upload: <input type="file" name="file"><br /> 
		<input type="text" name="productType" id= "productType" hidden="true" />
		<input type="text" name="vendorCode" id= "vendorCode"  hidden=""/>
		<label for="chkReal">
            <input type="radio" checked="checked" id="chkReal" name="chkImages" onclick="ShowHideDiv()" /> Real
        </label>
       	<label for="chkVirtual">
            <input type="radio" id="chkVirtual" name="chkImages" onclick="ShowHideDiv()" /> Virtual
        </label>
        <div id="vendorURL" style="display: none"> 
        URL: <input type="text" id="txtPassportNumber"  name="url" />
        </div>
        <input type="submit" value="Upload" id="upload"/>
        	</form>
        </div>
    </div>
</div>
        </div>
    </div>
</div>

<script>
    function ShowHideDiv() {
        var chkVirtual = document.getElementById("chkVirtual");
        var vendorURL = document.getElementById("vendorURL");
        vendorURL.style.display = chkVirtual.checked ? "block" : "none";
    }
</script>

<script type="text/javascript">
$(document).ready(function(){
	
	$("#cat").change(function(){
		var cat = $("#cat").val();
		$.ajax({
            url: 'http://10.11.19.19:9191/erp/getSubcat/'+cat,
            crossDomain: true,
            type: 'GET',
            success: function (data) {
            	var subcat = data["value"]["Subcat"];
            	$("#subcat").empty();
            	$("#subcat").append("<option value=''>Select a Subcategory</option>");
            	for(i=0;i<subcat.length;i++)
            	{
            		
            		$('<option/>').val(subcat[i]).html(subcat[i]).appendTo('#subcat');
            	}
            	$( "#subcat" ).prop( "disabled", false );
            	$( "#producttype" ).prop( "disabled", true );

           	}
        });
	})

	$("#subcat").change(function(){
		var cat = $("#cat").val();
		var subcat = $("#subcat").val();
		$.ajax({
            url: 'http://10.11.19.19:9191/erp/getProductType/'+cat+'/'+subcat,
            crossDomain: true,
            type: 'GET',
            success: function (data) {
            	var pt = data["value"]["PT"];
            	$("#producttype").empty();
            	$("#producttype").append("<option value=''>Select a Product Type</option>");
            	for(i=0;i<pt.length;i++)
            	{
            		$('<option/>').val(pt[i]).html(pt[i]).appendTo('#producttype');
            	}
            	$( "#producttype" ).prop( "disabled", false );

           	}
        });
	})	

	$("#producttype").change(function(){
		var pt = $("#producttype").val();
		$.ajax({
            url: 'http://10.11.19.19:9191/erp/getUploadFormat/'+pt,
            crossDomain: true,
            type: 'GET',
            success: function (data) {
            	var arrCSV= data["value"]["Fields"];
				var csvString = arrCSV.join(",");
				var a         = document.createElement('a');
				a.href        = 'data:attachment/csv,' + csvString;
				a.target      = '_blank';
				a.download    = pt+'.csv';

				document.body.appendChild(a);
				a.click();
				$('#productType').val(pt);
				$('#vendorCode').val($.cookie("vendorCode"));
				$('#uploadForm').toggle();
           	}
        });
	})

		$("#upload").click(function(e){
			e.preventDefault();

			alert("upload");
	})
	
});
</script>
</body>
</html>


